<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:include="includes :: indexHead"></head>
<body class="blue-grey lighten-5">
<main th:inline="text">
    <div th:include="navbar :: navHome"></div>

    <section th:style="'background:url('+ @{${gig.gigArt}}+'); background-size: 400%; background-repeat: no-repeat; background-position: center; height: 500px; filter: blur(10px); -webkit-filter: blur(10px);'">
    </section>
    <div class="gig container">
        <nav class="gigNav transparent">

                <ul class="right">
                    <li th:if="${gig.companyProfile.user.username == user.username}" sec:authorize="hasRole('ROLE_COMPANY')" class="col s4">
                        <a class="waves-effect waves-light btn-floating modal-trigger" href="#gigUpdate">
                            <i class="material-icons  tooltipped" data-position="top" data-delay="50" data-tooltip="Update Gig">edit</i>
                        </a>

                    </li>
                    <li th:if="${gig.companyProfile.user.username == user.username}" sec:authorize="hasRole('ROLE_COMPANY')" class="col s4">
                        <a class="waves-effect waves-light btn-floating modal-trigger" href="#gigDelete">
                            <i class="material-icons  tooltipped" data-position="top" data-delay="50" data-tooltip="Delete Gig">delete</i>
                        </a>

                    </li>
                </ul>


        </nav>
        <section class="gigTitle white">
            <p><b>[[${gig.gigTitle}]]</b><span class="gigType right">[[${gig.gigType}]]</span></p>
        </section>
        <img class="gigImage" th:src="${gig.gigArt}" th:alt="${gig.gigTitle}"/>
        <section class="timePlace white">
            <div class="row">
                <div class="col s6 " style="border-right: 1px solid lightgray">
                    <p class="valign-wrapper"><i class="orange-text text-accent-4 material-icons">event</i>
                        [[${#dates.format(gig.gigStart,'EEE, d MMM yyyy')}]]
                        <span style="margin-left: 3px;" th:if="${gig.gigStart != gig.gigEnd}"> to [[${#dates.format(gig.gigEnd,'EEE, d MMM yyyy')}]]</span>
                    </p>

                </div>
                <div class="col s6">
                    <p class="valign-wrapper"><i class="orange-text text-accent-4 material-icons">access_time</i>[[${gig.timeStart}]] to [[${gig.timeEnd}]]</p>

                </div>
            </div>
        </section>

        <section th:style="'background:url('+ @{${url}}+'); background-size: cover; background-repeat: no-repeat; background-position: center; height: 200px;'">
            <div class="locationBox right">
                <div class="row">
                    <div class="col s8">
                        [[${gig.gigLocation}]]
                    </div>
                    <div class="col s4">
                        <a th:href="'https://www.google.com/maps/place/'+ @{${gig.gigLocation}}" target="_blank" class="waves-effect waves-light btn-floating tooltipped" data-position="top" data-delay="50" data-tooltip="Directions"><i class="material-icons">map</i></a>

                    </div>
                </div>
            </div>
        </section>
        <section class="gigDescript center-align white">[[${gig.gigDescription}]]</section>
        <section sec:authorize="hasRole('ROLE_COMPANY')" class="musiciansApplied white">
        <div class="row valign-wrapper">
            <div class="col s2">
                <p class="appliedTitle"><span class="appliedNum">[[${gig.getMusicianApplyGigs().size()}]]</span> <br/>Musicians Applied </p>
            </div>
            <div class="col s10 ">
                <a th:each="applied : ${applied}" th:href="'/company/find-bands/' + @{${applied.musicianProfile.id}}" >
                    <img  th:src="@{${applied.musicianProfile.profPicImage}} " class="appliedAvatar circle"/>
                </a>
            </div>
        </div>
        </section>
        <section class="white center-align">
            <div sec:authorize="hasRole('ROLE_MUSICIAN')">
                <form  th:action="'/musician/gig/'+ @{${gig.id}} + '/apply'" method="post">
                    <input type="submit" class="waves-effect waves-light btn-large" value="Apply for Gig"/>
                </form>
            </div>
        </section>
    </div>



</main>
<div th:include="modals :: gigUpdate"></div>
<div th:include="modals :: gigDelete"></div>
<div th:include="footer :: footer"></div>

<span th:include="includes :: js"></span>

</body>
</html>